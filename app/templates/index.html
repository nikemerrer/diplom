<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <title>Извлечение реквизитов договора</title>
  <link rel="stylesheet" href="{{ url_for('static', path='style.css') }}">
  <style>
    body { font-family: system-ui, Arial, sans-serif; background: #f6f8fa; color: #111; margin: 0; }
    .container { max-width: 1100px; margin: 0 auto; padding: 24px; }
    h1 { margin: 0 0 16px 0; }
    .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    .box { background: #fff; border: 1px solid #d0d7de; border-radius: 10px; padding: 16px; }
    .row { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
    .btn { background: #1f6feb; color: #fff; border: 0; padding: 8px 14px; border-radius: 8px; cursor: pointer; }
    .btn:hover { filter: brightness(1.05); }
    textarea { width: 100%; height: 420px; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; border: 1px solid #d0d7de; border-radius: 8px; padding: 10px; }
    pre { background: #0d1117; color: #e6edf3; border: 1px solid #30363d; border-radius: 10px; padding: 12px; max-height: 70vh; overflow: auto; }
    .muted { color: #57606a; font-size: 14px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Извлечение реквизитов договора</h1>

    <div class="grid">
      <div class="box">
        <h2>Входной файл</h2>
        <form method="post" action="/" enctype="multipart/form-data">
          <div class="row">
            <input type="file" name="file" accept=".doc,.docx,.pdf,.txt" required>
            <button class="btn" type="submit">Обработать</button>
          </div>
          <p class="muted">Поддерживаем: .docx, .doc, .pdf, .txt</p>
        </form>

        {% if filename %}
          <p class="muted">Файл: <strong>{{ filename }}</strong></p>
        {% endif %}

        <h3>Превью текста</h3>
        <textarea readonly>{{ text }}</textarea>
      </div>

      <div class="box">
        <h2>Результат (JSON)</h2>
        {% if json_str %}
          <form method="post" action="/download-json">
            <input type="hidden" name="json_payload" value="{{ json_str }}">
            <button class="btn" type="submit">Скачать JSON</button>
          </form>
          <h3>Просмотр</h3>
          <pre>{{ json_str }}</pre>
        {% else %}
          <p class="muted">Загрузите документ слева, чтобы увидеть результат.</p>
        {% endif %}
      </div>
    </div>

    <footer class="muted" style="margin-top:16px;">
      API: POST <code>/api/extract-file</code> (multipart/form-data, поле <code>file</code>)
    </footer>
  </div>
</body>
</html>
